# Security Bundle
## Roles
* used [AuraJS](https://github.com/massiveart/sulu-docs/blob/master/detail-specification/000-foundation/DET-003-Frontend.md)
* standard bundle with rest service for roles
* matrix component for displaying permissions in form/main.js
 * listen to events for changing permissions and update object which will be transfered by save event afterwards

## Authentication
* Used standard [http://symfony.com/doc/current/book/security.html#how-security-works-authentication-and-authorization](symfony components)
* configureable in `app/config/security.yml`
 * `security.encoders` defines the encoding for the password of each entity

## Authorization
* Used symfony components
* Implemented Voter for our own Permissions
* Implemented own UserProvider (for avoiding lazy loading)
* Check permissions in a Controller
* Instead of 'Your security context' also an object or an object idendity can be used (then you are not checking for general system rights, but for an specific object generated by a user)

```php
$this->get('security.context')->isGranted(array(
    'permission' => 'view|add|edit|delete|archive|live|security',
    'locale' => 'Your locale' //this one is optional
), 'Your security context');
```

For making this easier, there is our own `SecurityChecker`, which can be accessed like this (result would be the same as above):

```php
$this->get('sulu_security.security_checker')->hasPermission(
    'Your security context',
    'view|add|edit|delete|archive|live|security',
    'Your locale'
);
```

Alternatively you can use the `checkPermission` method, which will throw an exception if the operation is not granted.

## SecurityListener
There is also a SecurityListener, which checks the security for every action on a controller implementing the 
`SecuredContollerInterface`. All the Controller has to do is to implement the two methods. `getSecurityContext`
should return the name of the SecurityContext used by this controller, and a `getLocale`-method, which gets
the `Request`-object, and should determine the locale. Usually this one has not to be implemented, because
the abstract `RestController` already does.

The listener automatically checks the correct permission type based on the HTTP method. Please consider that
the Controller has also to implement the `ClassResourceInterface` from the `FOSRestBundle`, otherwise this
will not work correctly for business logic encapsulated in a `POST`.
